<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>SIRIUS: sirius::Potential Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SIRIUS
   &#160;<span id="projectnumber">4.1</span>
   </div>
   <div id="projectbrief">Electronic structure library and applications</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacesirius.html">sirius</a></li><li class="navelem"><a class="el" href="classsirius_1_1_potential.html">Potential</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classsirius_1_1_potential-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">sirius::Potential Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Generate effective potential from charge density and magnetization.  
 <a href="classsirius_1_1_potential.html#details">More...</a></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Collaboration diagram for sirius::Potential:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><!-- SVG 0 -->
</div>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsirius_1_1_potential_1_1paw__potential__data__t.html">paw_potential_data_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a8d779e124012d2eb74e622b91774c2ea"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsirius_1_1_potential.html#a8d779e124012d2eb74e622b91774c2ea">Potential</a> (<a class="el" href="classsirius_1_1_simulation__context.html">Simulation_context</a> &amp;ctx__)</td></tr>
<tr class="memdesc:a8d779e124012d2eb74e622b91774c2ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#a8d779e124012d2eb74e622b91774c2ea">More...</a><br /></td></tr>
<tr class="separator:a8d779e124012d2eb74e622b91774c2ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb014b9a7c5ecc5f79ba84bb99e9abc1"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aeb014b9a7c5ecc5f79ba84bb99e9abc1"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>set_effective_potential_ptr</b> (double *veffmt, double *veffit)</td></tr>
<tr class="separator:aeb014b9a7c5ecc5f79ba84bb99e9abc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae936ac0b1e58bc928671b147aea2cf8a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae936ac0b1e58bc928671b147aea2cf8a"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>set_effective_magnetic_field_ptr</b> (double *beffmt, double *beffit)</td></tr>
<tr class="separator:ae936ac0b1e58bc928671b147aea2cf8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45701c46c8961f2ea5c089286802cf47"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsirius_1_1_potential.html#a45701c46c8961f2ea5c089286802cf47">zero</a> ()</td></tr>
<tr class="memdesc:a45701c46c8961f2ea5c089286802cf47"><td class="mdescLeft">&#160;</td><td class="mdescRight">Zero effective potential and magnetic field.  <a href="#a45701c46c8961f2ea5c089286802cf47">More...</a><br /></td></tr>
<tr class="separator:a45701c46c8961f2ea5c089286802cf47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada6c62c577c4e91e06490423345e833a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsirius_1_1_potential.html#ada6c62c577c4e91e06490423345e833a">poisson</a> (<a class="el" href="classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *rho, <a class="el" href="classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *vh)</td></tr>
<tr class="memdesc:ada6c62c577c4e91e06490423345e833a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Poisson solver.  <a href="#ada6c62c577c4e91e06490423345e833a">More...</a><br /></td></tr>
<tr class="separator:ada6c62c577c4e91e06490423345e833a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1abe0a0486f01331b8baf7a359523ae6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsirius_1_1_potential.html#a1abe0a0486f01331b8baf7a359523ae6">xc</a> (<a class="el" href="classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *rho, <a class="el" href="classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *magnetization[3], <a class="el" href="classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *vxc, <a class="el" href="classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *bxc[3], <a class="el" href="classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *exc)</td></tr>
<tr class="memdesc:a1abe0a0486f01331b8baf7a359523ae6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate XC potential and energy density.  <a href="#a1abe0a0486f01331b8baf7a359523ae6">More...</a><br /></td></tr>
<tr class="separator:a1abe0a0486f01331b8baf7a359523ae6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abddbb842b28ba0f62653393aca53b4e7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsirius_1_1_potential.html#abddbb842b28ba0f62653393aca53b4e7">generate</a> (<a class="el" href="classsirius_1_1_density.html">Density</a> &amp;density__)</td></tr>
<tr class="memdesc:abddbb842b28ba0f62653393aca53b4e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate effective potential and magnetic field from charge density and magnetization.  <a href="#abddbb842b28ba0f62653393aca53b4e7">More...</a><br /></td></tr>
<tr class="separator:abddbb842b28ba0f62653393aca53b4e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a476007fa356fb79d01cf829a69b26430"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a476007fa356fb79d01cf829a69b26430"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>save</b> ()</td></tr>
<tr class="separator:a476007fa356fb79d01cf829a69b26430"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4531df46202e7c0495ff7a389351486d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4531df46202e7c0495ff7a389351486d"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>load</b> ()</td></tr>
<tr class="separator:a4531df46202e7c0495ff7a389351486d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57df8029903153c8c6e4f8c71347334e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a57df8029903153c8c6e4f8c71347334e"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>update_atomic_potential</b> ()</td></tr>
<tr class="separator:a57df8029903153c8c6e4f8c71347334e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa15c3084148757dd135180fe287e4497"><td class="memTemplParams" colspan="2"><a class="anchor" id="aa15c3084148757dd135180fe287e4497"></a>
template&lt;device_t pu&gt; </td></tr>
<tr class="memitem:aa15c3084148757dd135180fe287e4497"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><b>add_mt_contribution_to_pw</b> ()</td></tr>
<tr class="separator:aa15c3084148757dd135180fe287e4497"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef421db1d4ce4ece0be0cea7e0f0b12c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsirius_1_1_potential.html#aef421db1d4ce4ece0be0cea7e0f0b12c">generate_pw_coefs</a> ()</td></tr>
<tr class="memdesc:aef421db1d4ce4ece0be0cea7e0f0b12c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate plane-wave coefficients of the potential in the interstitial region.  <a href="#aef421db1d4ce4ece0be0cea7e0f0b12c">More...</a><br /></td></tr>
<tr class="separator:aef421db1d4ce4ece0be0cea7e0f0b12c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac53f9c549fb2e2a5e02992a823e792e7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsirius_1_1_potential.html#ac53f9c549fb2e2a5e02992a823e792e7">generate_D_operator_matrix</a> ()</td></tr>
<tr class="memdesc:ac53f9c549fb2e2a5e02992a823e792e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate D operator from potential and augmentation charge.  <a href="#ac53f9c549fb2e2a5e02992a823e792e7">More...</a><br /></td></tr>
<tr class="separator:ac53f9c549fb2e2a5e02992a823e792e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7bdec7be7e6c4e71866dda172c4545b5"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7bdec7be7e6c4e71866dda172c4545b5"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>generate_PAW_effective_potential</b> (<a class="el" href="classsirius_1_1_density.html">Density</a> &amp;<a class="el" href="sirius__api_8cpp.html#a27c9852fd9c283b3432aaea8d778ab45">density</a>)</td></tr>
<tr class="separator:a7bdec7be7e6c4e71866dda172c4545b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c5bd2a5f8c04ba5543520be68a4bcec"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6c5bd2a5f8c04ba5543520be68a4bcec"></a>
std::vector&lt; double &gt; const &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>PAW_hartree_energies</b> () const </td></tr>
<tr class="separator:a6c5bd2a5f8c04ba5543520be68a4bcec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b24e1e07b6eb8a037142fb4baf2e3d0"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6b24e1e07b6eb8a037142fb4baf2e3d0"></a>
std::vector&lt; double &gt; const &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>PAW_xc_energies</b> () const </td></tr>
<tr class="separator:a6b24e1e07b6eb8a037142fb4baf2e3d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b9815edd04a4b62b2e945e629d5bda1"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2b9815edd04a4b62b2e945e629d5bda1"></a>
std::vector&lt; double &gt; const &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>PAW_core_energies</b> () const </td></tr>
<tr class="separator:a2b9815edd04a4b62b2e945e629d5bda1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1af2a4f2ca781f0c842fe22c8bcc0ec9"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1af2a4f2ca781f0c842fe22c8bcc0ec9"></a>
std::vector&lt; double &gt; const &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>PAW_one_elec_energies</b> ()</td></tr>
<tr class="separator:a1af2a4f2ca781f0c842fe22c8bcc0ec9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae50b9ec60146386653585ec486a596ef"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae50b9ec60146386653585ec486a596ef"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>PAW_hartree_total_energy</b> () const </td></tr>
<tr class="separator:ae50b9ec60146386653585ec486a596ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b05b8c5036288a410dcbd3194bb74dd"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6b05b8c5036288a410dcbd3194bb74dd"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>PAW_xc_total_energy</b> () const </td></tr>
<tr class="separator:a6b05b8c5036288a410dcbd3194bb74dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bdf7caa8cf160a2e12a5bd4861d158b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4bdf7caa8cf160a2e12a5bd4861d158b"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>PAW_total_core_energy</b> () const </td></tr>
<tr class="separator:a4bdf7caa8cf160a2e12a5bd4861d158b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59352b8aeb4d6f99ea3989a8ac0b8a80"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a59352b8aeb4d6f99ea3989a8ac0b8a80"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>PAW_total_energy</b> ()</td></tr>
<tr class="separator:a59352b8aeb4d6f99ea3989a8ac0b8a80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d2b0a795b5cf57f24180ca17f705237"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8d2b0a795b5cf57f24180ca17f705237"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>PAW_one_elec_energy</b> ()</td></tr>
<tr class="separator:a8d2b0a795b5cf57f24180ca17f705237"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70e4eb1dbbe61223cfa9ec8e21f90252"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a70e4eb1dbbe61223cfa9ec8e21f90252"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>check_potential_continuity_at_mt</b> ()</td></tr>
<tr class="separator:a70e4eb1dbbe61223cfa9ec8e21f90252"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac44993cfb63ba04c3c9f4cc472652852"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsirius_1_1_potential.html#ac44993cfb63ba04c3c9f4cc472652852">size</a> ()</td></tr>
<tr class="memdesc:ac44993cfb63ba04c3c9f4cc472652852"><td class="mdescLeft">&#160;</td><td class="mdescRight">Total size (number of elements) of the potential and effective magnetic field.  <a href="#ac44993cfb63ba04c3c9f4cc472652852">More...</a><br /></td></tr>
<tr class="separator:ac44993cfb63ba04c3c9f4cc472652852"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab22e33a6cda1b03e1e5edeaa822c100b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab22e33a6cda1b03e1e5edeaa822c100b"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>pack</b> (<a class="el" href="classsirius_1_1_mixer.html">Mixer</a>&lt; double &gt; &amp;mixer)</td></tr>
<tr class="separator:ab22e33a6cda1b03e1e5edeaa822c100b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcc8dc4110691d5f463615e4136cbcab"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="adcc8dc4110691d5f463615e4136cbcab"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>unpack</b> (double const *buffer)</td></tr>
<tr class="separator:adcc8dc4110691d5f463615e4136cbcab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a443f5d205079f20dce528b54578366e0"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a443f5d205079f20dce528b54578366e0"></a>
<a class="el" href="classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *&#160;</td><td class="memItemRight" valign="bottom"><b>effective_potential</b> ()</td></tr>
<tr class="separator:a443f5d205079f20dce528b54578366e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a168c22ea67abc3e469df4edbcd014329"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a168c22ea67abc3e469df4edbcd014329"></a>
<a class="el" href="classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>local_potential</b> ()</td></tr>
<tr class="separator:a168c22ea67abc3e469df4edbcd014329"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07b930da44036d4e39309178206b2d5a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a07b930da44036d4e39309178206b2d5a"></a>
<a class="el" href="classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; spectral, double &gt; const &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>effective_potential_mt</b> (int ialoc) const </td></tr>
<tr class="separator:a07b930da44036d4e39309178206b2d5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af844022ac55fcc4d585a18eba63f2392"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af844022ac55fcc4d585a18eba63f2392"></a>
<a class="el" href="classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; **&#160;</td><td class="memItemRight" valign="bottom"><b>effective_magnetic_field</b> ()</td></tr>
<tr class="separator:af844022ac55fcc4d585a18eba63f2392"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45f621d622fd4504da2034cc1095ee21"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a45f621d622fd4504da2034cc1095ee21"></a>
<a class="el" href="classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *&#160;</td><td class="memItemRight" valign="bottom"><b>effective_magnetic_field</b> (int i)</td></tr>
<tr class="separator:a45f621d622fd4504da2034cc1095ee21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1a2076417d10b35cf5c60d58c3c34c7"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab1a2076417d10b35cf5c60d58c3c34c7"></a>
<a class="el" href="classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *&#160;</td><td class="memItemRight" valign="bottom"><b>hartree_potential</b> ()</td></tr>
<tr class="separator:ab1a2076417d10b35cf5c60d58c3c34c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1db6a3e2ad5caa83cf42abb7db07b076"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1db6a3e2ad5caa83cf42abb7db07b076"></a>
<a class="el" href="classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; spectral, double &gt; const &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>hartree_potential_mt</b> (int ialoc) const </td></tr>
<tr class="separator:a1db6a3e2ad5caa83cf42abb7db07b076"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74e9cc35a382cbc46e3a6785510116c7"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a74e9cc35a382cbc46e3a6785510116c7"></a>
<a class="el" href="classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *&#160;</td><td class="memItemRight" valign="bottom"><b>xc_potential</b> ()</td></tr>
<tr class="separator:a74e9cc35a382cbc46e3a6785510116c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac536b306a32fe14ebdbb90bfe62684dc"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac536b306a32fe14ebdbb90bfe62684dc"></a>
<a class="el" href="classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *&#160;</td><td class="memItemRight" valign="bottom"><b>xc_energy_density</b> ()</td></tr>
<tr class="separator:ac536b306a32fe14ebdbb90bfe62684dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a777819dae8634b13a2fb428d9591a72a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a777819dae8634b13a2fb428d9591a72a"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>allocate</b> ()</td></tr>
<tr class="separator:a777819dae8634b13a2fb428d9591a72a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab873eb099e9c93512827085e851f5108"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab873eb099e9c93512827085e851f5108"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>vh_el</b> (int ia)</td></tr>
<tr class="separator:ab873eb099e9c93512827085e851f5108"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a578e355eab53f1d5ff56cffbd01a14b6"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a578e355eab53f1d5ff56cffbd01a14b6"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>energy_vha</b> ()</td></tr>
<tr class="separator:a578e355eab53f1d5ff56cffbd01a14b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a482cc560311a0348c2e9bfd8a82d19a1"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a482cc560311a0348c2e9bfd8a82d19a1"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>mixer_init</b> ()</td></tr>
<tr class="separator:a482cc560311a0348c2e9bfd8a82d19a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f1e857853010be663c403737ff9fbb1"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0f1e857853010be663c403737ff9fbb1"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>mix</b> ()</td></tr>
<tr class="separator:a0f1e857853010be663c403737ff9fbb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af81314dcc38d837764cec2d41aaf0cab"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af81314dcc38d837764cec2d41aaf0cab"></a>
double_complex const &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>veff_pw</b> (int ig__) const </td></tr>
<tr class="separator:af81314dcc38d837764cec2d41aaf0cab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a2a2223620919200acdcd849d0dce3b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6a2a2223620919200acdcd849d0dce3b"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>set_veff_pw</b> (double_complex *veff_pw__)</td></tr>
<tr class="separator:a6a2a2223620919200acdcd849d0dce3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88797e14b5485d569ca62a9b7df70208"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a88797e14b5485d569ca62a9b7df70208"></a>
double_complex const &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>rm_inv_pw</b> (int ig__) const </td></tr>
<tr class="separator:a88797e14b5485d569ca62a9b7df70208"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1757190f305d595265737af57fd66f5"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa1757190f305d595265737af57fd66f5"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>set_rm_inv_pw</b> (double_complex *rm_inv_pw__)</td></tr>
<tr class="separator:aa1757190f305d595265737af57fd66f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b67ac853bafec92e0aa5de2201431fe"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1b67ac853bafec92e0aa5de2201431fe"></a>
double_complex const &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>rm2_inv_pw</b> (int ig__) const </td></tr>
<tr class="separator:a1b67ac853bafec92e0aa5de2201431fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05a695c7951b7b6fdb04e9af5bcb5b31"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a05a695c7951b7b6fdb04e9af5bcb5b31"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>set_rm2_inv_pw</b> (double_complex *rm2_inv_pw__)</td></tr>
<tr class="separator:a05a695c7951b7b6fdb04e9af5bcb5b31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3d19f763090fa0ee612e35d3e1dabe2"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af3d19f763090fa0ee612e35d3e1dabe2"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>fft_transform</b> (int direction__)</td></tr>
<tr class="separator:af3d19f763090fa0ee612e35d3e1dabe2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a3c711c33b95fff9172c892d7dcc680fc"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3c711c33b95fff9172c892d7dcc680fc"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>init_PAW</b> ()</td></tr>
<tr class="separator:a3c711c33b95fff9172c892d7dcc680fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9037f4eb265f5115b23e53b8ee3c6998"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9037f4eb265f5115b23e53b8ee3c6998"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>xc_mt_PAW_nonmagnetic</b> (<a class="el" href="classsirius_1_1_radial__grid.html">Radial_grid</a> const &amp;rgrid, mdarray&lt; double, 3 &gt; &amp;out_atom_pot, mdarray&lt; double, 2 &gt; const &amp;full_rho_lm, std::vector&lt; double &gt; const &amp;rho_core)</td></tr>
<tr class="separator:a9037f4eb265f5115b23e53b8ee3c6998"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a795a3b0d958beaa647dc365314fbe87a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a795a3b0d958beaa647dc365314fbe87a"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>xc_mt_PAW_collinear</b> (<a class="el" href="classsirius_1_1_radial__grid.html">Radial_grid</a> const &amp;rgrid, mdarray&lt; double, 3 &gt; &amp;out_atom_pot, mdarray&lt; double, 2 &gt; const &amp;full_rho_lm, mdarray&lt; double, 3 &gt; const &amp;magnetization_lm, std::vector&lt; double &gt; const &amp;rho_core)</td></tr>
<tr class="separator:a795a3b0d958beaa647dc365314fbe87a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3620732074493dcebffd964f0584a355"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3620732074493dcebffd964f0584a355"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>xc_mt_PAW_noncollinear</b> ()</td></tr>
<tr class="separator:a3620732074493dcebffd964f0584a355"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab874e1a6d0498f8919647ddddb844596"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab874e1a6d0498f8919647ddddb844596"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>calc_PAW_local_potential</b> (<a class="el" href="structsirius_1_1_potential_1_1paw__potential__data__t.html">paw_potential_data_t</a> &amp;pdd, mdarray&lt; double, 2 &gt; const &amp;ae_full_density, mdarray&lt; double, 2 &gt; const &amp;ps_full_density, mdarray&lt; double, 3 &gt; const &amp;ae_local_magnetization, mdarray&lt; double, 3 &gt; const &amp;ps_local_magnetization)</td></tr>
<tr class="separator:ab874e1a6d0498f8919647ddddb844596"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae73d329c542ec894dd371ad3d4130aaf"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae73d329c542ec894dd371ad3d4130aaf"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>calc_PAW_local_Dij</b> (<a class="el" href="structsirius_1_1_potential_1_1paw__potential__data__t.html">paw_potential_data_t</a> &amp;pdd, mdarray&lt; double_complex, 4 &gt; &amp;paw_dij)</td></tr>
<tr class="separator:ae73d329c542ec894dd371ad3d4130aaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab290caf9c8ed3816f869d71efec279d3"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab290caf9c8ed3816f869d71efec279d3"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>calc_PAW_hartree_potential</b> (<a class="el" href="classsirius_1_1_atom.html">Atom</a> &amp;atom, const <a class="el" href="classsirius_1_1_radial__grid.html">Radial_grid</a> &amp;grid, mdarray&lt; double, 2 &gt; const &amp;full_density, mdarray&lt; double, 3 &gt; &amp;out_atom_pot)</td></tr>
<tr class="separator:ab290caf9c8ed3816f869d71efec279d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04c326ca240c84f7728375646da16e94"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a04c326ca240c84f7728375646da16e94"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>calc_PAW_one_elec_energy</b> (<a class="el" href="structsirius_1_1_potential_1_1paw__potential__data__t.html">paw_potential_data_t</a> &amp;pdd, const mdarray&lt; double_complex, 4 &gt; &amp;density_matrix, const mdarray&lt; double_complex, 4 &gt; &amp;paw_dij)</td></tr>
<tr class="separator:a04c326ca240c84f7728375646da16e94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3bc1de5a8c117611d0dc0e7dba408a9"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af3bc1de5a8c117611d0dc0e7dba408a9"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>add_paw_Dij_to_atom_Dmtrx</b> ()</td></tr>
<tr class="separator:af3bc1de5a8c117611d0dc0e7dba408a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1df196fb2d0109666c57be81b7d39197"><td class="memTemplParams" colspan="2">template&lt;bool free_atom&gt; </td></tr>
<tr class="memitem:a1df196fb2d0109666c57be81b7d39197"><td class="memTemplItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classsirius_1_1_potential.html#a1df196fb2d0109666c57be81b7d39197">poisson_vmt</a> (<a class="el" href="classsirius_1_1_atom.html">Atom</a> const &amp;atom__, <a class="el" href="classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; function_domain_t::spectral, double &gt; const &amp;rho_mt__, <a class="el" href="classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; function_domain_t::spectral, double &gt; &amp;vha_mt__) const </td></tr>
<tr class="memdesc:a1df196fb2d0109666c57be81b7d39197"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solve Poisson equation for a single atom.  <a href="#a1df196fb2d0109666c57be81b7d39197">More...</a><br /></td></tr>
<tr class="separator:a1df196fb2d0109666c57be81b7d39197"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c8a0fb353b7544f6f114417a8627586"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsirius_1_1_potential.html#a1c8a0fb353b7544f6f114417a8627586">poisson_vmt</a> (<a class="el" href="classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *rho__, <a class="el" href="classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *vh__, <a class="el" href="classsddk_1_1mdarray.html">mdarray</a>&lt; double_complex, 2 &gt; &amp;qmt__)</td></tr>
<tr class="memdesc:a1c8a0fb353b7544f6f114417a8627586"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute MT part of the potential and MT multipole moments.  <a href="#a1c8a0fb353b7544f6f114417a8627586">More...</a><br /></td></tr>
<tr class="separator:a1c8a0fb353b7544f6f114417a8627586"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50dd31a86f55c9fee5b7264397bcb586"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsirius_1_1_potential.html#a50dd31a86f55c9fee5b7264397bcb586">poisson_sum_G</a> (int lmmax__, double_complex *fpw__, mdarray&lt; double, 3 &gt; &amp;fl__, mdarray&lt; double_complex, 2 &gt; &amp;flm__)</td></tr>
<tr class="memdesc:a50dd31a86f55c9fee5b7264397bcb586"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform a G-vector summation of plane-wave coefficiens multiplied by radial integrals.  <a href="#a50dd31a86f55c9fee5b7264397bcb586">More...</a><br /></td></tr>
<tr class="separator:a50dd31a86f55c9fee5b7264397bcb586"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1e5381fc52a6d366849c48daf4fdc32"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsirius_1_1_potential.html#ac1e5381fc52a6d366849c48daf4fdc32">poisson_add_pseudo_pw</a> (mdarray&lt; double_complex, 2 &gt; &amp;qmt, mdarray&lt; double_complex, 2 &gt; &amp;qit, double_complex *rho_pw)</td></tr>
<tr class="memdesc:ac1e5381fc52a6d366849c48daf4fdc32"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add contribution from the pseudocharge to the plane-wave expansion.  <a href="#ac1e5381fc52a6d366849c48daf4fdc32">More...</a><br /></td></tr>
<tr class="separator:ac1e5381fc52a6d366849c48daf4fdc32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4383d38a605d0b6367da339035e0130"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsirius_1_1_potential.html#ab4383d38a605d0b6367da339035e0130">generate_local_potential</a> ()</td></tr>
<tr class="memdesc:ab4383d38a605d0b6367da339035e0130"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate local part of pseudo potential.  <a href="#ab4383d38a605d0b6367da339035e0130">More...</a><br /></td></tr>
<tr class="separator:ab4383d38a605d0b6367da339035e0130"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ca95ee1cfa05528bab436c0fdda5a34"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7ca95ee1cfa05528bab436c0fdda5a34"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>xc_mt_nonmagnetic</b> (<a class="el" href="classsirius_1_1_radial__grid.html">Radial_grid</a> const &amp;rgrid, std::vector&lt; <a class="el" href="classsirius_1_1_x_c__functional.html">XC_functional</a> &gt; &amp;xc_func, <a class="el" href="classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; spectral, double &gt; const &amp;rho_lm, <a class="el" href="classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; spatial, double &gt; &amp;rho_tp, <a class="el" href="classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; spatial, double &gt; &amp;vxc_tp, <a class="el" href="classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; spatial, double &gt; &amp;exc_tp)</td></tr>
<tr class="separator:a7ca95ee1cfa05528bab436c0fdda5a34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2e7e5c77b137dc93c47787c4b6c36a3"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad2e7e5c77b137dc93c47787c4b6c36a3"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>xc_mt_magnetic</b> (<a class="el" href="classsirius_1_1_radial__grid.html">Radial_grid</a> const &amp;rgrid, std::vector&lt; <a class="el" href="classsirius_1_1_x_c__functional.html">XC_functional</a> &gt; &amp;xc_func, <a class="el" href="classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; spectral, double &gt; &amp;rho_up_lm, <a class="el" href="classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; spatial, double &gt; &amp;rho_up_tp, <a class="el" href="classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; spectral, double &gt; &amp;rho_dn_lm, <a class="el" href="classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; spatial, double &gt; &amp;rho_dn_tp, <a class="el" href="classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; spatial, double &gt; &amp;vxc_up_tp, <a class="el" href="classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; spatial, double &gt; &amp;vxc_dn_tp, <a class="el" href="classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; spatial, double &gt; &amp;exc_tp)</td></tr>
<tr class="separator:ad2e7e5c77b137dc93c47787c4b6c36a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9dd2d9a79897292706a4ca8a78cd0271"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9dd2d9a79897292706a4ca8a78cd0271"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>xc_mt</b> (<a class="el" href="classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *rho, <a class="el" href="classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *magnetization[3], std::vector&lt; <a class="el" href="classsirius_1_1_x_c__functional.html">XC_functional</a> &gt; &amp;xc_func, <a class="el" href="classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *vxc, <a class="el" href="classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *bxc[3], <a class="el" href="classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *exc)</td></tr>
<tr class="separator:a9dd2d9a79897292706a4ca8a78cd0271"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a599c0a7539faf2afab6df28fe71d3e13"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a599c0a7539faf2afab6df28fe71d3e13"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>xc_it_nonmagnetic</b> (<a class="el" href="classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *rho, std::vector&lt; <a class="el" href="classsirius_1_1_x_c__functional.html">XC_functional</a> &gt; &amp;xc_func, <a class="el" href="classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *vxc, <a class="el" href="classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *exc)</td></tr>
<tr class="separator:a599c0a7539faf2afab6df28fe71d3e13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0356021fa84663766fa310670f081828"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0356021fa84663766fa310670f081828"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>xc_it_magnetic</b> (<a class="el" href="classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *rho, <a class="el" href="classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *magnetization[3], std::vector&lt; <a class="el" href="classsirius_1_1_x_c__functional.html">XC_functional</a> &gt; &amp;xc_func, <a class="el" href="classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *vxc, <a class="el" href="classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *bxc[3], <a class="el" href="classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *exc)</td></tr>
<tr class="separator:a0356021fa84663766fa310670f081828"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b987c41157fb2d5da2d435548aad410"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8b987c41157fb2d5da2d435548aad410"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>init</b> ()</td></tr>
<tr class="separator:a8b987c41157fb2d5da2d435548aad410"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a107236a8e284b239b9a888587aa5bd53"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a107236a8e284b239b9a888587aa5bd53"></a>
<a class="el" href="classsirius_1_1_simulation__context.html">Simulation_context</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>ctx_</b></td></tr>
<tr class="separator:a107236a8e284b239b9a888587aa5bd53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa94f0458ddf8c127759e0b73de16acc6"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa94f0458ddf8c127759e0b73de16acc6"></a>
<a class="el" href="classsirius_1_1_unit__cell.html">Unit_cell</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>unit_cell_</b></td></tr>
<tr class="separator:aa94f0458ddf8c127759e0b73de16acc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1aa716bb6ae5c3b5ca6ae44b262fac94"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1aa716bb6ae5c3b5ca6ae44b262fac94"></a>
<a class="el" href="classsddk_1_1_communicator.html">Communicator</a> const &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>comm_</b></td></tr>
<tr class="separator:a1aa716bb6ae5c3b5ca6ae44b262fac94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a425f6b348a9f68d5c1d0111db8cba503"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a425f6b348a9f68d5c1d0111db8cba503"></a>
std::unique_ptr&lt; <a class="el" href="classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>effective_potential_</b></td></tr>
<tr class="separator:a425f6b348a9f68d5c1d0111db8cba503"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e7f3670059c6058606df29b3de45bd6"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1e7f3670059c6058606df29b3de45bd6"></a>
<a class="el" href="classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *&#160;</td><td class="memItemRight" valign="bottom"><b>effective_magnetic_field_</b> [3]</td></tr>
<tr class="separator:a1e7f3670059c6058606df29b3de45bd6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a284e8ab6cc17f161da074086e1f081e1"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a284e8ab6cc17f161da074086e1f081e1"></a>
<a class="el" href="classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *&#160;</td><td class="memItemRight" valign="bottom"><b>hartree_potential_</b></td></tr>
<tr class="separator:a284e8ab6cc17f161da074086e1f081e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20dca9a8eaedcc61f700cdeb3ffb44bd"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a20dca9a8eaedcc61f700cdeb3ffb44bd"></a>
<a class="el" href="classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *&#160;</td><td class="memItemRight" valign="bottom"><b>xc_potential_</b></td></tr>
<tr class="separator:a20dca9a8eaedcc61f700cdeb3ffb44bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1f6f7b2c1c85b230c34ba39e9fd9318"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad1f6f7b2c1c85b230c34ba39e9fd9318"></a>
<a class="el" href="classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *&#160;</td><td class="memItemRight" valign="bottom"><b>xc_energy_density_</b></td></tr>
<tr class="separator:ad1f6f7b2c1c85b230c34ba39e9fd9318"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4071c9c5b14fd52005538e4de6e7943d"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsirius_1_1_potential.html#a4071c9c5b14fd52005538e4de6e7943d">local_potential_</a></td></tr>
<tr class="memdesc:a4071c9c5b14fd52005538e4de6e7943d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Local part of pseudopotential.  <a href="#a4071c9c5b14fd52005538e4de6e7943d">More...</a><br /></td></tr>
<tr class="separator:a4071c9c5b14fd52005538e4de6e7943d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1dc9c74958d3e7d11bbfbb1aa0bbb4b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae1dc9c74958d3e7d11bbfbb1aa0bbb4b"></a>
<a class="el" href="classsddk_1_1mdarray.html">mdarray</a>&lt; double, 3 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>sbessel_mom_</b></td></tr>
<tr class="separator:ae1dc9c74958d3e7d11bbfbb1aa0bbb4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2d7e1a92fa0ce8754648315bb4acce3"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab2d7e1a92fa0ce8754648315bb4acce3"></a>
<a class="el" href="classsddk_1_1mdarray.html">mdarray</a>&lt; double, 3 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>sbessel_mt_</b></td></tr>
<tr class="separator:ab2d7e1a92fa0ce8754648315bb4acce3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6095f630f2f5b843d901538a0f37f04e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6095f630f2f5b843d901538a0f37f04e"></a>
<a class="el" href="classsddk_1_1mdarray.html">mdarray</a>&lt; double, 2 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>gamma_factors_R_</b></td></tr>
<tr class="separator:a6095f630f2f5b843d901538a0f37f04e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7648173e3f1d0edc91d221c934b8e736"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7648173e3f1d0edc91d221c934b8e736"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>lmax_</b></td></tr>
<tr class="separator:a7648173e3f1d0edc91d221c934b8e736"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75a43cb1413d564463a2895d691a959d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a75a43cb1413d564463a2895d691a959d"></a>
std::unique_ptr&lt; <a class="el" href="classsirius_1_1_s_h_t.html">SHT</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>sht_</b></td></tr>
<tr class="separator:a75a43cb1413d564463a2895d691a959d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a781473e76bf903a5822000662c3b4414"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a781473e76bf903a5822000662c3b4414"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>pseudo_density_order_</b></td></tr>
<tr class="separator:a781473e76bf903a5822000662c3b4414"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1010a62cf2d65377fb1a8c0020849b24"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1010a62cf2d65377fb1a8c0020849b24"></a>
std::vector&lt; double_complex &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>zil_</b></td></tr>
<tr class="separator:a1010a62cf2d65377fb1a8c0020849b24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab01d0a3fd83573cf6b6b34e3d1ef6ce7"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab01d0a3fd83573cf6b6b34e3d1ef6ce7"></a>
std::vector&lt; double_complex &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>zilm_</b></td></tr>
<tr class="separator:ab01d0a3fd83573cf6b6b34e3d1ef6ce7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2a1abca8860b91354ab61c141b76a4f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae2a1abca8860b91354ab61c141b76a4f"></a>
std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>l_by_lm_</b></td></tr>
<tr class="separator:ae2a1abca8860b91354ab61c141b76a4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae474479d1266ed12f5196d887f9b88e1"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae474479d1266ed12f5196d887f9b88e1"></a>
<a class="el" href="classsddk_1_1mdarray.html">mdarray</a>&lt; double_complex, 2 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>gvec_ylm_</b></td></tr>
<tr class="separator:ae474479d1266ed12f5196d887f9b88e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b3cee2d4ec5d7c841bb401729a1960a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1b3cee2d4ec5d7c841bb401729a1960a"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>energy_vha_</b></td></tr>
<tr class="separator:a1b3cee2d4ec5d7c841bb401729a1960a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0126d2afa48714b359eede273905a64c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classsddk_1_1mdarray.html">mdarray</a>&lt; double, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsirius_1_1_potential.html#a0126d2afa48714b359eede273905a64c">vh_el_</a></td></tr>
<tr class="memdesc:a0126d2afa48714b359eede273905a64c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Electronic part of Hartree potential.  <a href="#a0126d2afa48714b359eede273905a64c">More...</a><br /></td></tr>
<tr class="separator:a0126d2afa48714b359eede273905a64c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd62ab6e7ac9e9995722e8caebbf0478"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abd62ab6e7ac9e9995722e8caebbf0478"></a>
std::unique_ptr&lt; <a class="el" href="classsirius_1_1_mixer.html">Mixer</a>&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>mixer_</b> {nullptr}</td></tr>
<tr class="separator:abd62ab6e7ac9e9995722e8caebbf0478"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab013e57ad7b7e10dcb6526379b768eb"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aab013e57ad7b7e10dcb6526379b768eb"></a>
std::vector&lt; <a class="el" href="classsirius_1_1_x_c__functional.html">XC_functional</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>xc_func_</b></td></tr>
<tr class="separator:aab013e57ad7b7e10dcb6526379b768eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf213a65c122ebe4ed46b02560174da8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classsddk_1_1mdarray.html">mdarray</a>&lt; double_complex, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsirius_1_1_potential.html#adf213a65c122ebe4ed46b02560174da8">veff_pw_</a></td></tr>
<tr class="memdesc:adf213a65c122ebe4ed46b02560174da8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Plane-wave coefficients of the effective potential weighted by the unit step-function.  <a href="#adf213a65c122ebe4ed46b02560174da8">More...</a><br /></td></tr>
<tr class="separator:adf213a65c122ebe4ed46b02560174da8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a681931c08f11ddea4b3709280d7b309d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classsddk_1_1mdarray.html">mdarray</a>&lt; double_complex, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsirius_1_1_potential.html#a681931c08f11ddea4b3709280d7b309d">rm_inv_pw_</a></td></tr>
<tr class="memdesc:a681931c08f11ddea4b3709280d7b309d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Plane-wave coefficients of the inverse relativistic mass weighted by the unit step-function.  <a href="#a681931c08f11ddea4b3709280d7b309d">More...</a><br /></td></tr>
<tr class="separator:a681931c08f11ddea4b3709280d7b309d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71c1a995bc68a97d48e004999cd2b8a0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classsddk_1_1mdarray.html">mdarray</a>&lt; double_complex, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsirius_1_1_potential.html#a71c1a995bc68a97d48e004999cd2b8a0">rm2_inv_pw_</a></td></tr>
<tr class="memdesc:a71c1a995bc68a97d48e004999cd2b8a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Plane-wave coefficients of the squared inverse relativistic mass weighted by the unit step-function.  <a href="#a71c1a995bc68a97d48e004999cd2b8a0">More...</a><br /></td></tr>
<tr class="separator:a71c1a995bc68a97d48e004999cd2b8a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a444caac8abc61a7b0c7b1cf1685ab67d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a444caac8abc61a7b0c7b1cf1685ab67d"></a>
std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>paw_hartree_energies_</b></td></tr>
<tr class="separator:a444caac8abc61a7b0c7b1cf1685ab67d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb48c608fe5fdc14b200ec50a21bca12"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="acb48c608fe5fdc14b200ec50a21bca12"></a>
std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>paw_xc_energies_</b></td></tr>
<tr class="separator:acb48c608fe5fdc14b200ec50a21bca12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fa98d38946a062e90e717375fa5a66a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4fa98d38946a062e90e717375fa5a66a"></a>
std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>paw_core_energies_</b></td></tr>
<tr class="separator:a4fa98d38946a062e90e717375fa5a66a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a543259d27f0e07764ce7347c7adf3018"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a543259d27f0e07764ce7347c7adf3018"></a>
std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>paw_one_elec_energies_</b></td></tr>
<tr class="separator:a543259d27f0e07764ce7347c7adf3018"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ecb8ae450a712a26dc1b91ad8348e28"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6ecb8ae450a712a26dc1b91ad8348e28"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>paw_hartree_total_energy_</b> {0.0}</td></tr>
<tr class="separator:a6ecb8ae450a712a26dc1b91ad8348e28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b07d2b2ee776efdb34a64b4041ecb87"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0b07d2b2ee776efdb34a64b4041ecb87"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>paw_xc_total_energy_</b> {0.0}</td></tr>
<tr class="separator:a0b07d2b2ee776efdb34a64b4041ecb87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51b0a21e62d33305653555820c8e656a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a51b0a21e62d33305653555820c8e656a"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>paw_total_core_energy_</b> {0.0}</td></tr>
<tr class="separator:a51b0a21e62d33305653555820c8e656a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1328b6bfd09912ade6b156476cd2752"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af1328b6bfd09912ade6b156476cd2752"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>paw_one_elec_energy_</b> {0.0}</td></tr>
<tr class="separator:af1328b6bfd09912ade6b156476cd2752"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a190a0617e74f0cce2aed286680c74a17"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a190a0617e74f0cce2aed286680c74a17"></a>
std::vector&lt; <a class="el" href="structsirius_1_1_potential_1_1paw__potential__data__t.html">paw_potential_data_t</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>paw_potential_data_</b></td></tr>
<tr class="separator:a190a0617e74f0cce2aed286680c74a17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39bd1b7cb3db41258aa286c2ee0af3a3"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a39bd1b7cb3db41258aa286c2ee0af3a3"></a>
<a class="el" href="classsddk_1_1mdarray.html">mdarray</a>&lt; double_complex, 4 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>paw_dij_</b></td></tr>
<tr class="separator:a39bd1b7cb3db41258aa286c2ee0af3a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a556afd6462fb98e93aa0293651273a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4a556afd6462fb98e93aa0293651273a"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>max_paw_basis_size_</b> {0}</td></tr>
<tr class="separator:a4a556afd6462fb98e93aa0293651273a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Generate effective potential from charge density and magnetization. </p>
<dl class="section note"><dt>Note</dt><dd>At some point we need to update the atomic potential with the new MT potential. This is simple if the effective potential is a global function. Otherwise we need to pass the effective potential between MPI ranks. This is also simple, but requires some time. It is also easier to mix the global functions. </dd></dl>

<p>Definition at line <a class="el" href="potential_8h_source.html#l00039">39</a> of file <a class="el" href="potential_8h_source.html">potential.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a8d779e124012d2eb74e622b91774c2ea"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">sirius::Potential::Potential </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classsirius_1_1_simulation__context.html">Simulation_context</a> &amp;&#160;</td>
          <td class="paramname"><em>ctx__</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructor. </p>

<p>Definition at line <a class="el" href="potential_8h_source.html#l00390">390</a> of file <a class="el" href="potential_8h_source.html">potential.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a1df196fb2d0109666c57be81b7d39197"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;bool free_atom&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; sirius::Potential::poisson_vmt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classsirius_1_1_atom.html">Atom</a> const &amp;&#160;</td>
          <td class="paramname"><em>atom__</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; function_domain_t::spectral, double &gt; const &amp;&#160;</td>
          <td class="paramname"><em>rho_mt__</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classsirius_1_1_spheric__function.html">Spheric_function</a>&lt; function_domain_t::spectral, double &gt; &amp;&#160;</td>
          <td class="paramname"><em>vha_mt__</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Solve Poisson equation for a single atom. </p>

<p>Definition at line <a class="el" href="potential_8h_source.html#l00171">171</a> of file <a class="el" href="potential_8h_source.html">potential.h</a>.</p>

</div>
</div>
<a class="anchor" id="a1c8a0fb353b7544f6f114417a8627586"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Potential::poisson_vmt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>rho__</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>vh__</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classsddk_1_1mdarray.html">mdarray</a>&lt; double_complex, 2 &gt; &amp;&#160;</td>
          <td class="paramname"><em>qmt__</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute MT part of the potential and MT multipole moments. </p>

<p>Definition at line <a class="el" href="potential_8h_source.html#l00239">239</a> of file <a class="el" href="potential_8h_source.html">potential.h</a>.</p>

</div>
</div>
<a class="anchor" id="a50dd31a86f55c9fee5b7264397bcb586"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Potential::poisson_sum_G </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lmmax__</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double_complex *&#160;</td>
          <td class="paramname"><em>fpw__</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">mdarray&lt; double, 3 &gt; &amp;&#160;</td>
          <td class="paramname"><em>fl__</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">mdarray&lt; double_complex, 2 &gt; &amp;&#160;</td>
          <td class="paramname"><em>flm__</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Perform a G-vector summation of plane-wave coefficiens multiplied by radial integrals. </p>
<p>The following operation is performed: </p><p class="formulaDsp">
\[ q_{\ell m}^{\alpha} = \sum_{\bf G} 4\pi \rho({\bf G}) e^{i{\bf G}{\bf r}_{\alpha}}i^{\ell}f_{\ell}^{\alpha}(G) Y_{\ell m}^{*}(\hat{\bf G}) \]
</p>
 
<p>Definition at line <a class="el" href="poisson_8hpp_source.html#l00006">6</a> of file <a class="el" href="poisson_8hpp_source.html">poisson.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="ac1e5381fc52a6d366849c48daf4fdc32"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Potential::poisson_add_pseudo_pw </td>
          <td>(</td>
          <td class="paramtype">mdarray&lt; double_complex, 2 &gt; &amp;&#160;</td>
          <td class="paramname"><em>qmt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">mdarray&lt; double_complex, 2 &gt; &amp;&#160;</td>
          <td class="paramname"><em>qit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double_complex *&#160;</td>
          <td class="paramname"><em>rho_pw</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Add contribution from the pseudocharge to the plane-wave expansion. </p>

<p>Definition at line <a class="el" href="poisson_8hpp_source.html#l00072">72</a> of file <a class="el" href="poisson_8hpp_source.html">poisson.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="ab4383d38a605d0b6367da339035e0130"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Potential::generate_local_potential </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generate local part of pseudo potential. </p>
<p>Total local potential is a lattice sum: </p><p class="formulaDsp">
\[ V({\bf r}) = \sum_{{\bf T},\alpha} V_{\alpha}({\bf r} - {\bf T} - {\bf \tau}_{\alpha}) \]
</p>
<p> We want to compute it's plane-wave expansion coefficients: </p><p class="formulaDsp">
\[ V({\bf G}) = \frac{1}{V} \int e^{-i{\bf Gr}} V({\bf r}) d{\bf r} = \frac{1}{V} \sum_{{\bf T},\alpha} \int e^{-i{\bf Gr}}V_{\alpha}({\bf r} - {\bf T} - {\bf \tau}_{\alpha})d{\bf r} \]
</p>
<p> Standard change of variables: \( {\bf r}&#39; = {\bf r} - {\bf T} - {\bf \tau}_{\alpha},\; {\bf r} = {\bf r}&#39; + {\bf T} + {\bf \tau}_{\alpha} \) leads to: </p><p class="formulaDsp">
\[ V({\bf G}) = \frac{1}{V} \sum_{{\bf T},\alpha} \int e^{-i{\bf G}({\bf r}&#39; + {\bf T} + {\bf \tau}_{\alpha})}V_{\alpha}({\bf r}&#39;)d{\bf r&#39;} = \frac{N}{V} \sum_{\alpha} \int e^{-i{\bf G}({\bf r}&#39; + {\bf \tau}_{\alpha})}V_{\alpha}({\bf r}&#39;)d{\bf r&#39;} = \frac{1}{\Omega} \sum_{\alpha} e^{-i {\bf G} {\bf \tau}_{\alpha} } \int e^{-i{\bf G}{\bf r}}V_{\alpha}({\bf r})d{\bf r} \]
</p>
<p> Using the well-known expansion of a plane wave in terms of spherical Bessel functions: </p><p class="formulaDsp">
\[ e^{i{\bf G}{\bf r}}=4\pi \sum_{\ell m} i^\ell j_{\ell}(Gr)Y_{\ell m}^{*}({\bf \hat G})Y_{\ell m}({\bf \hat r}) \]
</p>
<p> and remembering that for \( \ell = 0 \) (potential is sphericla) \( j_{0}(x) = \sin(x) / x \) we have: </p><p class="formulaDsp">
\[ V_{\alpha}({\bf G}) = \int V_{\alpha}(r) 4\pi \frac{\sin(Gr)}{Gr} Y^{*}_{00} Y_{00} r^2 \sin(\theta) dr d \phi d\theta = 4\pi \int V_{\alpha}(r) \frac{\sin(Gr)}{Gr} r^2 dr \]
</p>
<p> The tricky part comes next: \( V_{\alpha}({\bf r}) \) is a long-range potential &ndash; it decays slowly as \( -Z_{\alpha}^{p}/r \) and the straightforward integration with sperical Bessel function is numerically unstable. For \( {\bf G} = 0 \) an extra term \( Z_{\alpha}^p/r \), corresponding to the potential of pseudo-ion, is added to and removed from the local part of the atomic pseudopotential \( V_{\alpha}({\bf r}) \): </p><p class="formulaDsp">
\[ V_{\alpha}({\bf G} = 0) = \int V_{\alpha}({\bf r})d{\bf r} \Rightarrow 4\pi \int \Big( V_{\alpha}(r) + \frac{Z_{\alpha}^p}{r} \Big) r^2 dr - 4\pi \int \Big( \frac{Z_{\alpha}^p}{r} \Big) r^2 dr \]
</p>
<p> Second term corresponds to the average electrostatic potential of ions and it is ignored (like the \( {\bf G} = 0 \) term in the Hartree potential of electrons). For \( G \ne 0 \) the following trick is done: \( Z_{\alpha}^p {\rm erf}(r) / r \) is added to and removed from \( V_{\alpha}(r) \). The idea is to make potential decay quickly and then take the extra contribution analytically. We have: </p><p class="formulaDsp">
\[ V_{\alpha}({\bf G}) = 4\pi \int \Big(V_{\alpha}(r) + Z_{\alpha}^p \frac{{\rm erf}(r)} {r} - Z_{\alpha}^p \frac{{\rm erf}(r)}{r}\Big) \frac{\sin(Gr)}{Gr} r^2 dr \]
</p>
<p> Analytical contribution from the error function is computed using the 1D Fourier transform in complex plane: </p><p class="formulaDsp">
\[ \frac{1}{\sqrt{2 \pi}} \int_{-\infty}^{\infty} {\rm erf}(t) e^{i\omega t} dt = \frac{i e^{-\frac{\omega ^2}{4}} \sqrt{\frac{2}{\pi }}}{\omega } \]
</p>
<p> from which we immediately get </p><p class="formulaDsp">
\[ \int_{0}^{\infty} \frac{{\rm erf}(r)}{r} \frac{\sin(Gr)}{Gr} r^2 dr = \frac{e^{-\frac{G^2}{4}}}{G^2} \]
</p>
<p> The final expression for the local potential radial integrals for \( G \ne 0 \) take the following form: </p><p class="formulaDsp">
\[ 4\pi \int \Big(V_{\alpha}(r) r + Z_{\alpha}^p {\rm erf}(r) \Big) \frac{\sin(Gr)}{G} dr - \frac{e^{-\frac{G^2}{4}}}{G^2} \]
</p>
 
<p>Definition at line <a class="el" href="potential_8h_source.html#l00326">326</a> of file <a class="el" href="potential_8h_source.html">potential.h</a>.</p>

</div>
</div>
<a class="anchor" id="a45701c46c8961f2ea5c089286802cf47"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Potential::zero </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Zero effective potential and magnetic field. </p>

<p>Definition at line <a class="el" href="potential_8h_source.html#l00539">539</a> of file <a class="el" href="potential_8h_source.html">potential.h</a>.</p>

</div>
</div>
<a class="anchor" id="ada6c62c577c4e91e06490423345e833a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Potential::poisson </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>rho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>vh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Poisson solver. </p>
<p>Detailed explanation is available in:</p><ul>
<li>Weinert, M. (1981). Solution of Poisson's equation: beyond Ewald-type methods. Journal of Mathematical Physics, 22(11), 24332439. doi:10.1063/1.524800</li>
<li>Classical Electrodynamics Third Edition by J. D. Jackson.</li>
</ul>
<p>Solution of Poisson's equation for the muffin-tin geometry is carried out in several steps:</p><ul>
<li>True multipole moments \( q_{\ell m}^{\alpha} \) of the muffin-tin charge density are computed.</li>
<li>Pseudocharge density is introduced. Pseudocharge density coincides with the true charge density in the interstitial region and it's multipole moments inside muffin-tin spheres coincide with the true multipole moments.</li>
<li>Poisson's equation for the pseudocharge density is solved in the plane-wave domain. It gives the correct interstitial potential and correct muffin-tin boundary values.</li>
<li>Finally, muffin-tin part of potential is found by solving Poisson's equation in spherical coordinates with Dirichlet boundary conditions.</li>
</ul>
<p>We start by computing true multipole moments of the charge density inside the muffin-tin spheres: </p><p class="formulaDsp">
\[ q_{\ell m}^{\alpha} = \int Y_{\ell m}^{*}(\hat {\bf r}) r^{\ell} \rho({\bf r}) d {\bf r} = \int \rho_{\ell m}^{\alpha}(r) r^{\ell + 2} dr \]
</p>
<p> and for the nucleus with charge density \( \rho(r, \theta, \phi) = -\frac{Z \delta(r)}{4 \pi r^2} \): </p><p class="formulaDsp">
\[ q_{00}^{\alpha} = \int Y_{0 0} \frac{-Z_{\alpha} \delta(r)}{4 \pi r^2} r^2 \sin \theta dr d\phi d\theta = -Z_{\alpha} Y_{00} \]
</p>
<p>Now we need to get the multipole moments of the interstitial charge density \( \rho^{I}({\bf r}) \) inside muffin-tin spheres. We need this in order to estimate the amount of pseudocharge to be added to \( \rho^{I}({\bf r}) \) to get the pseudocharge multipole moments equal to the true multipole moments. We want to compute </p><p class="formulaDsp">
\[ q_{\ell m}^{I,\alpha} = \int Y_{\ell m}^{*}(\hat {\bf r}) r^{\ell} \rho^{I}({\bf r}) d {\bf r} \]
</p>
<p> where </p><p class="formulaDsp">
\[ \rho^{I}({\bf r}) = \sum_{\bf G}e^{i{\bf Gr}} \rho({\bf G}) \]
</p>
<p>Recall the spherical plane wave expansion: </p><p class="formulaDsp">
\[ e^{i{\bf G r}}=4\pi e^{i{\bf G r}_{\alpha}} \sum_{\ell m} i^\ell j_{\ell}(G|{\bf r}-{\bf r}_{\alpha}|) Y_{\ell m}^{*}({\bf \hat G}) Y_{\ell m}(\widehat{{\bf r}-{\bf r}_{\alpha}}) \]
</p>
<p> Multipole moments of each plane-wave are computed as: </p><p class="formulaDsp">
\[ q_{\ell m}^{\alpha}({\bf G}) = 4 \pi e^{i{\bf G r}_{\alpha}} Y_{\ell m}^{*}({\bf \hat G}) i^{\ell} \int_{0}^{R} j_{\ell}(Gr) r^{\ell + 2} dr = 4 \pi e^{i{\bf G r}_{\alpha}} Y_{\ell m}^{*}({\bf \hat G}) i^{\ell} \left\{\begin{array}{ll} \frac{R^{\ell + 2} j_{\ell + 1}(GR)}{G} &amp; G \ne 0 \\ \frac{R^3}{3} \delta_{\ell 0} &amp; G = 0 \end{array} \right. \]
</p>
<p>Final expression for the muffin-tin multipole moments of the interstitial charge denisty: </p><p class="formulaDsp">
\[ q_{\ell m}^{I,\alpha} = \sum_{\bf G}\rho({\bf G}) q_{\ell m}^{\alpha}({\bf G}) \]
</p>
<p>Now we are going to modify interstitial charge density inside the muffin-tin region in order to get the true multipole moments. We will add a pseudodensity of the form: </p><p class="formulaDsp">
\[ P({\bf r}) = \sum_{\ell m} p_{\ell m}^{\alpha} Y_{\ell m}(\hat {\bf r}) r^{\ell} \left(1-\frac{r^2}{R^2}\right)^n \]
</p>
<p> Radial functions of the pseudodensity are chosen in a special way. First, they produce a confined and smooth functions inside muffin-tins and second (most important) plane-wave coefficients of the pseudodensity can be computed analytically. Let's find the relation between \( p_{\ell m}^{\alpha} \) coefficients and true and interstitial multipole moments first. We are searching for the pseudodensity which restores the true multipole moments: </p><p class="formulaDsp">
\[ \int Y_{\ell m}^{*}(\hat {\bf r}) r^{\ell} \Big(\rho^{I}({\bf r}) + P({\bf r})\Big) d {\bf r} = q_{\ell m}^{\alpha} \]
</p>
<p> Then </p><p class="formulaDsp">
\[ p_{\ell m}^{\alpha} = \frac{q_{\ell m}^{\alpha} - q_{\ell m}^{I,\alpha}} {\int r^{2 \ell + 2} \left(1-\frac{r^2}{R^2}\right)^n dr} = (q_{\ell m}^{\alpha} - q_{\ell m}^{I,\alpha}) \frac{2 \Gamma(5/2 + \ell + n)}{R^{2\ell + 3}\Gamma(3/2 + \ell) \Gamma(n + 1)} \]
</p>
<p>Now let's find the plane-wave coefficients of \( P({\bf r}) \) inside each muffin-tin: </p><p class="formulaDsp">
\[ P^{\alpha}({\bf G}) = \frac{4\pi e^{-i{\bf G r}_{\alpha}}}{\Omega} \sum_{\ell m} (-i)^{\ell} Y_{\ell m}({\bf \hat G}) p_{\ell m}^{\alpha} \int_{0}^{R} j_{\ell}(G r) r^{\ell} \left(1-\frac{r^2}{R^2}\right)^n r^2 dr \]
</p>
<p>Integral of the spherical Bessel function with the radial pseudodensity component is taken analytically: </p><p class="formulaDsp">
\[ \int_{0}^{R} j_{\ell}(G r) r^{\ell} \left(1-\frac{r^2}{R^2}\right)^n r^2 dr = 2^n R^{\ell + 3} (GR)^{-n - 1} \Gamma(n + 1) j_{n + \ell + 1}(GR) \]
</p>
<p>The final expression for the pseudodensity plane-wave component is: </p><p class="formulaDsp">
\[ P^{\alpha}({\bf G}) = \frac{4\pi e^{-i{\bf G r}_{\alpha}}}{\Omega} \sum_{\ell m} (-i)^{\ell} Y_{\ell m}({\bf \hat G}) (q_{\ell m}^{\alpha} - q_{\ell m}^{I,\alpha}) \Big( \frac{2}{GR} \Big)^{n+1} \frac{ \Gamma(5/2 + n + \ell) } {R^{\ell} \Gamma(3/2+\ell)} \]
</p>
<p>For \( G=0 \) only \( \ell = 0 \) contribution survives: </p><p class="formulaDsp">
\[ P^{\alpha}({\bf G}=0) = \frac{4\pi}{\Omega} Y_{00} (q_{00}^{\alpha} - q_{00}^{I,\alpha}) \]
</p>
<p>We can now sum the contributions from all muffin-tin spheres and obtain a modified charge density, which is equal to the exact charge density in the interstitial region and which has correct multipole moments inside muffin-tin spheres: </p><p class="formulaDsp">
\[ \tilde \rho({\bf G}) = \rho({\bf G}) + \sum_{\alpha} P^{\alpha}({\bf G}) \]
</p>
<p> This density is used to solve the Poisson's equation in the plane-wave domain: </p><p class="formulaDsp">
\[ V_{H}({\bf G}) = \frac{4 \pi \tilde \rho({\bf G})}{G^2} \]
</p>
<p> The potential is correct in the interstitial region and also on the muffin-tin surface. We will use it to find the boundary conditions for the potential inside the muffin-tins. Using spherical plane-wave expansion we get: </p><p class="formulaDsp">
\[ V^{\alpha}_{\ell m}(R) = \sum_{\bf G} V_{H}({\bf G}) 4\pi e^{i{\bf G r}_{\alpha}} i^\ell j_{\ell}^{\alpha}(GR) Y_{\ell m}^{*}({\bf \hat G}) \]
</p>
<p>As soon as the muffin-tin boundary conditions for the potential are known, we can find the potential inside spheres using Dirichlet Green's function: </p><p class="formulaDsp">
\[ V({\bf x}) = \int \rho({\bf x&#39;})G_D({\bf x},{\bf x&#39;}) d{\bf x&#39;} - \frac{1}{4 \pi} \int_{S} V({\bf x&#39;}) \frac{\partial G_D}{\partial n&#39;} d{\bf S&#39;} \]
</p>
<p> where Dirichlet Green's function for the sphere is defined as: </p><p class="formulaDsp">
\[ G_D({\bf x},{\bf x&#39;}) = 4\pi \sum_{\ell m} \frac{Y_{\ell m}^{*}({\bf \hat x&#39;}) Y_{\ell m}(\hat {\bf x})}{2\ell + 1} \frac{r_{&lt;}^{\ell}}{r_{&gt;}^{\ell+1}}\Biggl(1 - \Big( \frac{r_{&gt;}}{R} \Big)^{2\ell + 1} \Biggr) \]
</p>
<p> and it's normal derivative at the surface is equal to: </p><p class="formulaDsp">
\[ \frac{\partial G_D}{\partial n&#39;} = -\frac{4 \pi}{R^2} \sum_{\ell m} \Big( \frac{r}{R} \Big)^{\ell} Y_{\ell m}^{*}({\bf \hat x&#39;}) Y_{\ell m}(\hat {\bf x}) \]
</p>
 
<p>Definition at line <a class="el" href="poisson_8hpp_source.html#l00127">127</a> of file <a class="el" href="poisson_8hpp_source.html">poisson.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a1abe0a0486f01331b8baf7a359523ae6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Potential::xc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>rho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>magnetization</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>vxc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>bxc</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classsirius_1_1_periodic__function.html">Periodic_function</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>exc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generate XC potential and energy density. </p>
<p>In case of spin-unpolarized GGA the XC potential has the following expression: </p><p class="formulaDsp">
\[ V_{XC}({\bf r}) = \frac{\partial}{\partial \rho} \varepsilon_{xc}(\rho, \nabla \rho) - \nabla \frac{\partial}{\partial (\nabla \rho)} \varepsilon_{xc}(\rho, \nabla \rho) \]
</p>
<p> LibXC packs the gradient information into the so-called <em>sigma</em> array: </p><p class="formulaDsp">
\[ \sigma = \nabla \rho \nabla \rho \]
</p>
<p> Changing variables in \( V_{XC} \) expression gives: </p><p class="formulaDsp">
\begin{eqnarray*} V_{XC}({\bf r}) &amp;=&amp; \frac{\partial}{\partial \rho} \varepsilon_{xc}(\rho, \sigma) - \nabla \frac{\partial \varepsilon_{xc}(\rho, \sigma)}{\partial \sigma} \frac{\partial \sigma}{ \partial (\nabla \rho)} \\ &amp;=&amp; \frac{\partial}{\partial \rho} \varepsilon_{xc}(\rho, \sigma) - 2 \nabla \frac{\partial \varepsilon_{xc}(\rho, \sigma)}{\partial \sigma} \nabla \rho - 2 \frac{\partial \varepsilon_{xc}(\rho, \sigma)}{\partial \sigma} \nabla^2 \rho \end{eqnarray*}
</p>
<p> The following sequence of functions must be computed:</p><ul>
<li>density on the real space grid</li>
<li>gradient of density (in spectral representation)</li>
<li>gradient of density on the real space grid</li>
<li>laplacian of density (in spectral representation)</li>
<li>laplacian of density on the real space grid</li>
<li><em>sigma</em> array</li>
<li>a call to Libxc must be performed <em>sigma</em> derivatives must be obtained</li>
<li>\( \frac{\partial \varepsilon_{xc}(\rho, \sigma)}{\partial \sigma} \) in spectral representation</li>
<li>gradient of \( \frac{\partial \varepsilon_{xc}(\rho, \sigma)}{\partial \sigma} \) in spectral representation</li>
<li>gradient of \( \frac{\partial \varepsilon_{xc}(\rho, \sigma)}{\partial \sigma} \) on the real space grid</li>
</ul>
<p>Expression for spin-polarized potential has a bit more complicated form: </p><p class="formulaDsp">
\begin{eqnarray*} V_{XC}^{\gamma} &amp;=&amp; \frac{\partial \varepsilon_{xc}}{\partial \rho_{\gamma}} - \nabla \Big( 2 \frac{\partial \varepsilon_{xc}}{\partial \sigma_{\gamma \gamma}} \nabla \rho_{\gamma} + \frac{\partial \varepsilon_{xc}}{\partial \sigma_{\gamma \delta}} \nabla \rho_{\delta} \Big) \\ &amp;=&amp; \frac{\partial \varepsilon_{xc}}{\partial \rho_{\gamma}} -2 \nabla \frac{\partial \varepsilon_{xc}}{\partial \sigma_{\gamma \gamma}} \nabla \rho_{\gamma} -2 \frac{\partial \varepsilon_{xc}}{\partial \sigma_{\gamma \gamma}} \nabla^2 \rho_{\gamma} - \nabla \frac{\partial \varepsilon_{xc}}{\partial \sigma_{\gamma \delta}} \nabla \rho_{\delta} - \frac{\partial \varepsilon_{xc}}{\partial \sigma_{\gamma \delta}} \nabla^2 \rho_{\delta} \end{eqnarray*}
</p>
<p> In magnetic case the "up" and "dn" density and potential decomposition is used. Using the fact that the effective magnetic field is parallel to magnetization at each point in space, we can write the coupling of density and magnetization with XC potential and XC magentic field as: </p><p class="formulaDsp">
\[ V_{xc}({\bf r}) \rho({\bf r}) + {\bf B}_{xc}({\bf r}){\bf m}({\bf r}) = V_{xc}({\bf r}) \rho({\bf r}) + {\rm B}_{xc}({\bf r}) {\rm m}({\bf r}) = V^{\uparrow}({\bf r})\rho^{\uparrow}({\bf r}) + V^{\downarrow}({\bf r})\rho^{\downarrow}({\bf r}) \]
</p>
<p> where </p><p class="formulaDsp">
\begin{eqnarray*} \rho^{\uparrow}({\bf r}) &amp;=&amp; \frac{1}{2}\Big( \rho({\bf r}) + {\rm m}({\bf r}) \Big) \\ \rho^{\downarrow}({\bf r}) &amp;=&amp; \frac{1}{2}\Big( \rho({\bf r}) - {\rm m}({\bf r}) \Big) \end{eqnarray*}
</p>
<p> and </p><p class="formulaDsp">
\begin{eqnarray*} V^{\uparrow}({\bf r}) &amp;=&amp; V_{xc}({\bf r}) + {\rm B}_{xc}({\bf r}) \\ V^{\downarrow}({\bf r}) &amp;=&amp; V_{xc}({\bf r}) - {\rm B}_{xc}({\bf r}) \end{eqnarray*}
</p>
 
<p>Definition at line <a class="el" href="xc_8hpp_source.html#l00854">854</a> of file <a class="el" href="xc_8hpp_source.html">xc.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="abddbb842b28ba0f62653393aca53b4e7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Potential::generate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classsirius_1_1_density.html">Density</a> &amp;&#160;</td>
          <td class="paramname"><em>density__</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generate effective potential and magnetic field from charge density and magnetization. </p>

<p>Definition at line <a class="el" href="potential_8h_source.html#l00756">756</a> of file <a class="el" href="potential_8h_source.html">potential.h</a>.</p>

</div>
</div>
<a class="anchor" id="aef421db1d4ce4ece0be0cea7e0f0b12c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Potential::generate_pw_coefs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generate plane-wave coefficients of the potential in the interstitial region. </p>

<p>Definition at line <a class="el" href="generate__pw__coefs_8hpp_source.html#l00001">1</a> of file <a class="el" href="generate__pw__coefs_8hpp_source.html">generate_pw_coefs.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="ac53f9c549fb2e2a5e02992a823e792e7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sirius::Potential::generate_D_operator_matrix </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate D operator from potential and augmentation charge. </p>
<p>The following real symmetric matrix is computed: </p><p class="formulaDsp">
\[ D_{\xi \xi&#39;}^{\alpha} = \int V({\bf r}) Q_{\xi \xi&#39;}^{\alpha}({\bf r}) d{\bf r} \]
</p>
<p> In the plane-wave domain this integrals transform into sum over Fourier components: </p><p class="formulaDsp">
\[ D_{\xi \xi&#39;}^{\alpha} = \sum_{\bf G} \langle V |{\bf G}\rangle \langle{\bf G}|Q_{\xi \xi&#39;}^{\alpha} \rangle = \sum_{\bf G} V^{*}({\bf G}) e^{-i{\bf r}_{\alpha}{\bf G}} Q_{\xi \xi&#39;}^{A}({\bf G}) = \sum_{\bf G} Q_{\xi \xi&#39;}^{A}({\bf G}) \tilde V_{\alpha}^{*}({\bf G}) \]
</p>
<p> where \( \alpha \) is the atom, \( A \) is the atom type and </p><p class="formulaDsp">
\[ \tilde V_{\alpha}({\bf G}) = e^{i{\bf r}_{\alpha}{\bf G}} V({\bf G}) \]
</p>
<p> Both \( V({\bf r}) \) and \( Q({\bf r}) \) functions are real and the following condition is fulfilled: </p><p class="formulaDsp">
\[ \tilde V_{\alpha}({\bf G}) = \tilde V_{\alpha}^{*}(-{\bf G}) \]
</p>
 <p class="formulaDsp">
\[ Q_{\xi \xi&#39;}({\bf G}) = Q_{\xi \xi&#39;}^{*}(-{\bf G}) \]
</p>
<p> In the sum over plane-wave coefficients the \( {\bf G} \) and \( -{\bf G} \) contributions will give: </p><p class="formulaDsp">
\[ Q_{\xi \xi&#39;}^{A}({\bf G}) \tilde V_{\alpha}^{*}({\bf G}) + Q_{\xi \xi&#39;}^{A}(-{\bf G}) \tilde V_{\alpha}^{*}(-{\bf G}) = 2 \Re \Big( Q_{\xi \xi&#39;}^{A}({\bf G}) \Big) \Re \Big( \tilde V_{\alpha}^{*}({\bf G}) \Big) + 2 \Im \Big( Q_{\xi \xi&#39;}^{A}({\bf G}) \Big) \Im \Big( \tilde V_{\alpha}^{*}({\bf G}) \Big) \]
</p>
<p> This allows the use of a <b>dgemm</b> instead of a <b>zgemm</b> when \( D_{\xi \xi&#39;}^{\alpha} \) matrix is calculated for all atoms of the same type. </p>

<p>Definition at line <a class="el" href="generate__d__operator__matrix_8hpp_source.html#l00035">35</a> of file <a class="el" href="generate__d__operator__matrix_8hpp_source.html">generate_d_operator_matrix.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="ac44993cfb63ba04c3c9f4cc472652852"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t sirius::Potential::size </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Total size (number of elements) of the potential and effective magnetic field. </p>

<p>Definition at line <a class="el" href="potential_8h_source.html#l00953">953</a> of file <a class="el" href="potential_8h_source.html">potential.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a4071c9c5b14fd52005538e4de6e7943d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classsirius_1_1_periodic__function.html">Periodic_function</a>&lt;double&gt; &gt; sirius::Potential::local_potential_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Local part of pseudopotential. </p>

<p>Definition at line <a class="el" href="potential_8h_source.html#l00058">58</a> of file <a class="el" href="potential_8h_source.html">potential.h</a>.</p>

</div>
</div>
<a class="anchor" id="a0126d2afa48714b359eede273905a64c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classsddk_1_1mdarray.html">mdarray</a>&lt;double, 1&gt; sirius::Potential::vh_el_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Electronic part of Hartree potential. </p>
<p>Used to compute electron-nuclear contribution to the total energy </p>

<p>Definition at line <a class="el" href="potential_8h_source.html#l00084">84</a> of file <a class="el" href="potential_8h_source.html">potential.h</a>.</p>

</div>
</div>
<a class="anchor" id="adf213a65c122ebe4ed46b02560174da8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classsddk_1_1mdarray.html">mdarray</a>&lt;double_complex, 1&gt; sirius::Potential::veff_pw_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Plane-wave coefficients of the effective potential weighted by the unit step-function. </p>

<p>Definition at line <a class="el" href="potential_8h_source.html#l00091">91</a> of file <a class="el" href="potential_8h_source.html">potential.h</a>.</p>

</div>
</div>
<a class="anchor" id="a681931c08f11ddea4b3709280d7b309d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classsddk_1_1mdarray.html">mdarray</a>&lt;double_complex, 1&gt; sirius::Potential::rm_inv_pw_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Plane-wave coefficients of the inverse relativistic mass weighted by the unit step-function. </p>

<p>Definition at line <a class="el" href="potential_8h_source.html#l00094">94</a> of file <a class="el" href="potential_8h_source.html">potential.h</a>.</p>

</div>
</div>
<a class="anchor" id="a71c1a995bc68a97d48e004999cd2b8a0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classsddk_1_1mdarray.html">mdarray</a>&lt;double_complex, 1&gt; sirius::Potential::rm2_inv_pw_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Plane-wave coefficients of the squared inverse relativistic mass weighted by the unit step-function. </p>

<p>Definition at line <a class="el" href="potential_8h_source.html#l00097">97</a> of file <a class="el" href="potential_8h_source.html">potential.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="potential_8h_source.html">potential.h</a></li>
<li><a class="el" href="generate__d__operator__matrix_8hpp_source.html">generate_d_operator_matrix.hpp</a></li>
<li><a class="el" href="generate__pw__coefs_8hpp_source.html">generate_pw_coefs.hpp</a></li>
<li><a class="el" href="_potential_2init_8hpp_source.html">Potential/init.hpp</a></li>
<li><a class="el" href="paw__potential_8hpp_source.html">paw_potential.hpp</a></li>
<li><a class="el" href="poisson_8hpp_source.html">poisson.hpp</a></li>
<li><a class="el" href="xc_8hpp_source.html">xc.hpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Mar 14 2017 16:27:29 for SIRIUS by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
